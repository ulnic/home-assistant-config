title: Nest
icon: mdi:monitor-dashboard
panel: true
background: "right/auto linear-gradient(23deg, rgba(211,211,211,1) 0%, rgba(223,223,223,1) 34%, rgba(255,255,255,1) 100%)"
path: nest-dash
cards:
  - type: vertical-stack
    cards:
      - type: custom:layout-card
        layout: horizontal
        #max_width: [20%, 100%]
        column_num: 1
        max_columns: 3
        cards:
          - type: vertical-stack
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:decluttering-card
                    template: nest_picture_button
                    variables:
                      - entity: person.nic
                      - entity_picture: /local/nic_ha.jpg
                  - type: custom:decluttering-card
                    template: nest_button
                    variables:
                      - entity: alarm_control_panel.ha_alarm
                      - state:
                          - value: 'armed_away'
                            icon: mdi:shield-lock
                            color: rgb(152,251,152)
                          - value: 'armed_home'
                            icon: mdi:shield-home
                            color: rgb(251, 210, 41)
                          - value: 'triggered'
                            icon: mdi:shield-alert
                            color: rgb(255, 0, 0)
                            styles:
                              icon:
                                - animation: blink 2s ease infinite
                          - value: 'disarmed'
                            icon: mdi:shield-off
                            color: rgb(169,169,169)
                          - value: 'pending'
                            icon: mdi:shield-half-full
                            color: rgb(169,169,169)
                            styles:
                              icon:
                                - animation: blink 2s ease infinite
                  - type: conditional
                    conditions:
                      - entity: input_boolean.guest_mode
                        state: "on"
                    card:
                      type: custom:decluttering-card
                      template: nest_picture_button
                      variables:
                        - entity: input_boolean.guest_mode
                        - entity_picture: /local/guest.png
                  - type: custom:decluttering-card
                    template: nest_picture_button
                    variables:
                      - entity: person.ulli
                      - entity_picture: /local/ulli_ha_sq.png
              - type: markdown
                content: |
                    # {{now() }}
                    # [[ sensor.time ]]

                    ### [[ sensor.date.state ]]
                style: |
                  ha-card {
                    margin-top: 80px;
                    margin-bottom: 200px;
                    background-color: rgba(0, 0, 0, 0);
                    font-family: 'Open Sans', sans-serif;
                    font-size: 200%;
                    -webkit-box-shadow: none;
                    -moz-box-shadow: none;
                    box-shadow: none;
                    text-align: center;
                  }
                  h1, h3 {
                    font-weight: 300 !important;
                  }
              - type: custom:weather-card
                entity: weather.dark_sky
                style: |
                  ha-card {
                    background-color: rgba(0, 0, 0, 0);
                    -webkit-box-shadow: none;
                    -moz-box-shadow: none;
                    box-shadow: none;
                  }

          - type: vertical-stack
            cards:
              - type: horizontal-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - type: "custom:atomic-calendar"
                        entities:
                          - entity: calendar.family
                        dateSize: 110
                        titleSize: 120
                        #height: 436px;
                        style: |
                          ha-card {
                            font-family: 'Open Sans', sans-serif;
                            margin-bottom: 10px;
                            margin-right: 5px;
                            margin-top: 10px;
                          }

                      #TODO
                      - type: custom:simple-thermostat
                        entity: climate.livingroom_ac
                        step_size: 1
                        sensors:
                          - entity: sensor.lumi_temperature_livingroom
                            name: Temp
                          #- entity: sensor.lumi_humidity_livingroom
                          #  name: humidity
                          #- attribute: min_temp
                          #  name: Min temp
                        control:
                          hvac:
                            some_mode: false
                            another_mode: false
                            'off':
                              name: Make it cold
                            icon: false
                            'on':
                              name: false
                              icon: mdi:whitewalker

                      - type: horizontal-stack
                        cards:
                          - type: vertical-stack
                            cards:
                              - type: horizontal-stack
                                cards:
                                - type: custom:mini-graph-card
                                  entities:
                                    - sensor.lumi_temperature_livingroom
                                  name: Livingroom
                                  show:
                                    icon: false
                                    fill: false
                                  height: 35
                                  color_thresholds:
                                    - value: 0
                                      color: "#CCE5FF"
                                    - value: 10
                                      color: "#66B2FF"
                                    - value: 15
                                      color: "#0080FF"
                                    - value: 18
                                      color: "#87c087"
                                    - value: 21
                                      color: "#389638"
                                    - value: 24
                                      color: "#FF9932"
                                    - value: 25
                                      color: "#FF8000"
                                    - value: 26
                                      color: "#ff0000"
                                  style: |
                                    ha-card {
                                      margin-right: 5px;
                                      margin-bottom: 5px;
                                    }
                                - type: custom:mini-graph-card
                                  entities:
                                    - sensor.lumi_temperature_kitchen
                                  name: Kitchen
                                  height: 35
                                  show:
                                    fill: false
                                    icon: false
                                  color_thresholds:
                                    - value: 0
                                      color: "#CCE5FF"
                                    - value: 10
                                      color: "#66B2FF"
                                    - value: 18
                                      color: "#0080FF"
                                    - value: 20
                                      color: "#87c087"
                                    - value: 21
                                      color: "#389638"
                                    - value: 24
                                      color: "#FF9932"
                                    - value: 25
                                      color: "#FF8000"
                                    - value: 26
                                      color: "#ff0000"
                                  style: |
                                    ha-card {
                                      margin-right: 5px;
                                      margin-bottom: 5px;
                                    }
                              - type: horizontal-stack
                                cards:
                                  - type: custom:mini-graph-card
                                    show:
                                      fill: false
                                      icon: false
                                    height: 35
                                    entities:
                                      - sensor.lumi_temperature_bedroom
                                    name: Bedroom
                                    color_thresholds:
                                      - value: 0
                                        color: "#CCE5FF"
                                      - value: 10
                                        color: "#66B2FF"
                                      - value: 18
                                        color: "#0080FF"
                                      - value: 20
                                        color: "#87c087"
                                      - value: 21
                                        color: "#389638"
                                      - value: 24
                                        color: "#FF9932"
                                      - value: 25
                                        color: "#FF8000"
                                      - value: 26
                                        color: "#ff0000"
                                    style: |
                                      ha-card {
                                        margin-right: 5px;
                                        margin-bottom: 5px;
                                      }
                                  - type: custom:mini-graph-card
                                    show:
                                      fill: false
                                      icon: false
                                    height: 35
                                    entities:
                                      - sensor.lumi_temperature_balcony
                                    name: Balcony
                                    color_thresholds:
                                      - value: 0
                                        color: "#CCE5FF"
                                      - value: 10
                                        color: "#66B2FF"
                                      - value: 18
                                        color: "#0080FF"
                                      - value: 20
                                        color: "#87c087"
                                      - value: 21
                                        color: "#389638"
                                      - value: 24
                                        color: "#FF9932"
                                      - value: 25
                                        color: "#FF8000"
                                      - value: 26
                                        color: "#ff0000"
                                    style: |
                                      ha-card {
                                        margin-right: 5px;
                                        margin-bottom: 5px;
                                      }

          - type: vertical-stack
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: "custom:button-card"
                        name:  Fan
                        color_type: icon
                        size: 25%
                        entity: fan.livingroom_ceiling_fan
                        show_label: true
                        label: >
                          ]]]
                          return (states['input_boolean.fan_state_livingroom'].state === 'on'
                            ? 'Speed ' + states['input_select.fan_speed_livingroom'].state
                            : '');
                          ]]]
                        tap_action:
                          action: toggle
                        double_tap_action:
                          action: call-service
                          service: script.turn_on
                          service_data:
                            entity_id: script.fan_increase_speed
                            variables:
                              room: 'livingroom'
                        hold_action:
                          action: more-info
                        styles:
                          card:
                            - height: 90px
                          label:
                            - font-size: 11px
                            - padding: 0px 5px

                      - type: "custom:button-card"
                        color_type: icon
                        entity: switch.media_unit
                        name: TV
                        size: 25%
                        show_label: true
                        show_last_changed: false
                        styles:
                          card:
                            - height: 90px
                          label:
                            - font-size: 11px
                            - padding: 0px 5px

                      - type: "custom:button-card"
                        color_type: icon
                        entity: switch.espresso
                        show_label: true
                        size: 25%
                        show_last_changed: true
                        styles:
                          card:
                            - height: 90px
                          label:
                            - font-size: 11px
                            - padding: 0px 5px
                        state:
                          - value: 'on'
                            styles:
                              state:
                                - color: green
                      # - type: "custom:button-card"
                      #   color_type: card
                      #   entity: switch.dishwasher
                      #   show_label: true
                      #   size: 25%
                      #   show_last_changed: true
                      #   tap_action:
                      #     action: ''
                      #   double_tap_action:
                      #     action: toggle
                      #   hold_action:
                      #     action: more-info
                      #   styles:
                      #     card:
                      #       - height: 90px
                      #     label:
                      #       - font-size: 11px
                      #       - padding: 0px 5px
                      #   state:
                      #     - value: 'on'
                      #       styles:
                      #         state:
                      #           - color: red

                      - type: "custom:button-card"
                        color_type: icon
                        name: All Lights
                        entity: light.master_switch
                        size: 25%
                        show_label: true
                        show_last_changed: false
                        styles:
                          card:
                            - height: 90px
                          label:
                            - font-size: 11px
                            - padding: 0px 5px

              - type: custom:vertical-stack-in-card
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:slider-entity-row
                        entity:  light.living_ceiling_lights
                        toggle: false
                        full_row: true

                      - type: custom:slider-entity-row
                        entity:  light.dining_lights
                        toggle: false
                        full_row: true
                  - type: horizontal-stack
                    cards:
                      - type: custom:decluttering-card
                        template: nest_icon_button
                        variables:
                          - entity: light.lifx_livingroom1
                          - name: Living TV
                      - type: custom:decluttering-card
                        template: nest_icon_button
                        variables:
                          - entity: light.lifx_livingroom2
                          - name: Living
                      - type: custom:decluttering-card
                        template: nest_icon_button
                        variables:
                          - entity: light.lifx_dining1
                          - name: Dining TV
                      - type: custom:decluttering-card
                        template: nest_icon_button
                        variables:
                          - entity: light.lifx_dining2
                          - name: Dining

              - type: custom:vertical-stack-in-card
                #title: Bedroom
                cards:
                  - type: custom:slider-entity-row
                    entity: light.bedroom_ceiling
                    toggle: false
                    full_row: true
                    name: Bedroom Ceiling

                  - type: horizontal-stack
                    cards:
                      - type: "custom:button-card"
                        name: Fan
                        #layout: icon_state_name2nd
                        color_type: icon
                        entity: fan.bedroom_ceiling_fan
                        show_label: true
                        size: 25%
                        label: >
                          [[[
                          return (states['input_boolean.fan_state_bedroom'].state === 'on'
                            ? 'Speed ' + states['input_select.fan_speed_bedroom'].state
                            : '');
                          ]]]
                        tap_action:
                          action: toggle
                        double_tap_action:
                          action: call-service
                          service: script.turn_on
                          service_data:
                            entity_id: script.fan_increase_speed
                            variables:
                              room: 'bedroom'
                        hold_action:
                          action: more-info
                        styles:
                          card:
                            - height: 70px
                          label:
                            - font-size: 12px
                            - padding: 0px 5px

                      - type: entity-button
                        entity: light.bedroom
                        name: Nightstand
                        tap_action:
                          action: toggle
                        hold_action:
                          action: more-info
                      - type: entity-button
                        entity: light.desk
                        name: Desk
                        tap_action:
                          action: toggle
                        hold_action:
                          action: more-info
                      - type: entity-button
                        entity: light.lifx_bedroom1
                        name: Desk ceiling
                        tap_action:
                          action: toggle
                        hold_action:
                          action: more-info
                      - type: entity-button
                        entity: light.lifx_bedroom2
                        name: Nics ceiling
                        tap_action:
                          action: toggle
                        hold_action:
                          action: more-info

              - type: horizontal-stack
                cards:
                  - type: custom:vertical-stack-in-card
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:decluttering-card
                            template: nest_icon_button
                            variables:
                              - entity: light.lifx_hallway_1
                              - name: Hallway
                          - type: custom:decluttering-card
                            template: nest_icon_button
                            variables:
                              - entity: light.lifx_laundry
                              - name: Laundry
                          - type: custom:decluttering-card
                            template: nest_icon_button
                            variables:
                              - entity: light.balcony_ceiling
                              - name: Balcony
                  - type: custom:vertical-stack-in-card
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:decluttering-card
                            template: nest_icon_button
                            variables:
                              - entity: light.led
                              - name: LED
                          - type: custom:decluttering-card
                            template: nest_icon_button
                            variables:
                              - entity: light.lifx_kitchen1
                              - name: Stove
                          - type: custom:decluttering-card
                            template: nest_icon_button
                            variables:
                              - entity: light.lifx_kitchen2
                              - name: Fridge

              - type: horizontal-stack
                cards:
                  - type: 'custom:home-feed-card'
                    title: Home Feed
                    show_empty: false
                    calendars:
                      - calendar.family
                    entities:
                      - switch.espresso
                      - binary_sensor.158_motion_nursery
                      - binary_sensor.lumi_motion_livingroom
                      - binary_sensor.158_door_laundry
                      - binary_sensor.motion_sensor_158_kitchen
                      - binary_sensor.lumi_motion_bedroom
                      - binary_sensor.lumi_door_nursery_balcony
                      - binary_sensor.door_sensor_158_nursery
                      - binary_sensor.lumi_door_laundry
                      - binary_sensor.door_sensor_158_hallway_cupboard
                      - binary_sensor.lumi_door_entrance
                      - binary_sensor.lumi_door_livingroom_balcony
                      - climate.livingroom_ac
                      # - entity: sensor.living_room_axis_movement_2
                      #   name: Living Room 2
                      #   secondary_info: last-changed
                    #height: 545px;
                    style: |
                      ha-card {
                        margin-top: 10px;
                        overflow: hidden;
                        font-family: 'Open Sans', sans-serif;
                      }
              
